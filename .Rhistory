ks_test_results <- apply(df0, 2, function(column) ks.test(column, "pnorm", mean(column), sd(column))$p.value)
result_t_test_df <- apply(t_test_df[, -1], 2, function(x) {
t.test(x ~ t_test_df$Treatment)
})
p_values <- sapply(result_t_test_df, function(x) x$p.value)
t_scores <- sapply(result_t_test_df, function(x) x$statistic)
summary_t_test_df <- data.frame(
Metabolite = colnames(t_test_df[, -1]),
p_value = p_values,
t_score = t_scores
)
View(summary_t_test_df)
library(dplyr)
library(readxl)
library(openxlsx)
df0 <- read.csv("metabolite_abundance.csv", row.names=1,header=TRUE)
df0[df0$Treatment=="No","Treatment"] <- "T1"
df0[df0$Treatment=="Yes","Treatment"] <- "T2"
# Kolmogorov-Smirnov Test for each column
ks_test_results <- apply(df0, 2, function(column) ks.test(column, "pnorm", mean(column), sd(column))$p.value)
#For non-normal, wilcox instead of t-test
w_test_mets <- ks_test_results_df %>%
filter(ks_test_results<0.05)
w_test_mets <- rownames(w_test_mets)
w_test_df <- df0[,w_test_mets]
w_test_df$Treatment <- c(rep("T1",10),rep("T2",10))
w_test_df <- data.frame(w_test_df[ncol(w_test_df)],w_test_df[1:ncol(w_test_df)-1])
# Separate groups
group1_w_test_df <- w_test_df[w_test_df$Treatment == "T1", ]
group2_w_test_df <- w_test_df[w_test_df$Treatment == "T2", ]
result_w_test_df <- apply(w_test_df[, -1], 2, function(x) {
wilcox.test(x ~ w_test_df$Treatment)
})
p_values2 <- sapply(result_w_test_df, function(x) x$p.value)
t_scores2 <- sapply(result_w_test_df, function(x) x$statistic)
# Create a summary table
summary_w_test_df <- data.frame(
Metabolite = colnames(w_test_df[, -1]),
p_value = p_values2,
t_score = t_scores2
)
all_summary <- rbind(summary_t_test_df, summary_w_test_df)
df1 <- as.data.frame(read_excel("global_metabolite_list.xlsx"))
all_summary$mz <- df1$`m/z`[match(all_summary$Metabolite,df1$ID)]
all_summary$rtime <- df1$RT[match(all_summary$Metabolite,df1$ID)]
all_summary$Name <- df1$Name[match(all_summary$Metabolite,df1$ID)]
all_summary$ID <- df1$ID[match(all_summary$Metabolite,df1$ID)]
all_summary$Higher <- df1$Higher[match(all_summary$Metabolite,df1$ID)]
all_summary$KEGG <- df1$KEGG.ID[match(all_summary$Metabolite,df1$ID)]
all_summary$ION<- df1$Ion.Mode[match(all_summary$Metabolite,df1$ID)]
neg_summary <- all_summary[all_summary$ION=="NEG",]
neg_summary <- data.frame(neg_summary[c(4:5,2:3)])
pos_summary <- all_summary[all_summary$ION=="POS",]
pos_summary <- data.frame(pos_summary[c(4:5,2:3)])
View(summary_t_test_df)
setwd("~/Desktop/Others/Portfolio/Metabolome_study")
#bubble plots
library(openxlsx)
#Load the following dataframes from MetaboAnalyst results
posdf <- read.csv("metaboanalyst/Positive/mummicho_pathway_enrichment_integ.csv")
negdf <- read.csv("metaboanalyst/Negative/mummicho_pathway_enrichment_integ.csv")
#Import these datafiles, because they should the compound hits
posdf2 <- read.csv("metaboanalyst/Positive/mummichog_pathway_enrichment_integ.csv")
negdf2 <- read.csv("metaboanalyst/Negative/mummichog_pathway_enrichment_integ.csv")
posdf$cpd.hits <- posdf2$cpd.hits[match(posdf$X,posdf2$X)]
negdf$cpd.hits <- negdf2$cpd.hits[match(negdf$X,negdf2$X)]
#bubble plots
library(openxlsx)
#Load the following dataframes from MetaboAnalyst results
posdf <- read.csv("metaboanalyst/Positive/mummicho_pathway_enrichment_integ.csv")
negdf <- read.csv("metaboanalyst/Negative/mummicho_pathway_enrichment_integ.csv")
#Import these datafiles, because they should the compound hits
posdf2 <- read.csv("metaboanalyst/Positive/mummichog_pathway_enrichment_integ.csv")
negdf2 <- read.csv("metaboanalyst/Negative/mummichog_pathway_enrichment_integ.csv")
#Merge them, get it from df2 add it to df2
posdf$cpd.hits <- posdf2$cpd.hits[match(posdf$X,posdf2$X)]
negdf$cpd.hits <- negdf2$cpd.hits[match(negdf$X,negdf2$X)]
#Importing files with t values stat
pos_stat <- read.csv("metaboanalyst/Positive/data_original.csv")
posdf3 <- read.csv("metaboanalyst/Positive/mummichog_matched_compound_all.csv")
colnames(posdf3) <- c("Mass","Compound","MatchedForm","MassDiff")
neg_stat <- read.csv("metaboanalyst/Negative/data_original.csv")
negdf3 <- read.csv("metaboanalyst/Negative/mummichog_matched_compound_all.csv")
colnames(negdf3) <- c("Mass","Compound","MatchedForm","MassDiff")
#For loop to get compound hits per pathway in positive mode, only including top 4
df0 <- data.frame()
for (x in 1:4) {
Compound <- unlist(strsplit(posdf$cpd.hits[x], ";"))
num <- as.numeric(length(unlist(strsplit(posdf$cpd.hits[x], ";"))))
Pathway <- rep(posdf[x,"X"],num)
Mode <- rep("Pos",num)
tmp <- data.frame(Compound,Pathway,Mode)
df0 <- rbind(df0,tmp)
}
View(df0)
#bubble plots
library(openxlsx)
#Load the following dataframes from MetaboAnalyst results
posdf <- read.csv("metaboanalyst/Positive/mummicho_pathway_enrichment_integ.csv")
negdf <- read.csv("metaboanalyst/Negative/mummicho_pathway_enrichment_integ.csv")
#Import these datafiles, because they should the compound hits
posdf2 <- read.csv("metaboanalyst/Positive/mummichog_pathway_enrichment_integ.csv")
negdf2 <- read.csv("metaboanalyst/Negative/mummichog_pathway_enrichment_integ.csv")
#Merge them, get it from df2 add it to df2
posdf$cpd.hits <- posdf2$cpd.hits[match(posdf$X,posdf2$X)]
negdf$cpd.hits <- negdf2$cpd.hits[match(negdf$X,negdf2$X)]
#Importing files with t values stat
pos_stat <- read.csv("metaboanalyst/Positive/data_original.csv")
posdf3 <- read.csv("metaboanalyst/Positive/mummichog_matched_compound_all.csv")
colnames(posdf3) <- c("Mass","Compound","MatchedForm","MassDiff")
neg_stat <- read.csv("metaboanalyst/Negative/data_original.csv")
negdf3 <- read.csv("metaboanalyst/Negative/mummichog_matched_compound_all.csv")
colnames(negdf3) <- c("Mass","Compound","MatchedForm","MassDiff")
#For loop to get compound hits per pathway in positive mode, only including top 4
df0 <- data.frame()
for (x in 1:4) {
Compound <- unlist(strsplit(posdf$cpd.hits[x], ";"))
num <- as.numeric(length(unlist(strsplit(posdf$cpd.hits[x], ";"))))
Pathway <- rep(posdf[x,"X"],num)
Mode <- rep("Pos",num)
tmp <- data.frame(Compound,Pathway,Mode)
df0 <- rbind(df0,tmp)
}
#Match compound id, by getting query mass, then which matches to another file with file with tval, pval
# df0$Mass <- posdf3$Query.Mass[match(df0$Compound,posdf3$Matched.Compound)]
df0_merged <- merge(df0, posdf3, by = "Compound")
df0_merged$Stat <- pos_stat$t.score[match(df0_merged$Mass,pos_stat$m.z)]
df0_merged$Pval <- pos_stat$p.value[match(df0_merged$Mass,pos_stat$m.z)]
df0_merged$Treatment <- ifelse(df0_merged$Stat>0,"T1","T2")
#negative mode, including top 8 so 1:8
df1 <- data.frame()
for (x in 1:8) {
Compound <- unlist(strsplit(negdf$cpd.hits[x], ";"))
num <- as.numeric(length(unlist(strsplit(negdf$cpd.hits[x], ";"))))
Pathway <- rep(negdf[x,"X"],num)
Mode <- rep("Neg",num)
tmp <- data.frame(Compound,Pathway,Mode)
df1 <- rbind(df1,tmp)
}
df1_merged <- merge(df1, negdf3, by = "Compound")
df1_merged$Stat <- neg_stat$t.score[match(df1_merged$Mass,neg_stat$m.z)]
df1_merged$Pval <- neg_stat$p.value[match(df1_merged$Mass,neg_stat$m.z)]
df1_merged$Treatment <- ifelse(df1_merged$Stat>0,"T1","T2")
#Bind both pos and neg compound hits
df_all <- rbind(df0_merged,df1_merged)
write.xlsx(df_all,"EnrichmentKEGGcompounds_stat.xlsx")
#Getting number of those significant elevated per treatment and per pathway
# Below is getting all per compound, a compound can have multiple matches
T1 <- c()
T2 <- c()
dfm <- rbind(posdf,negdf)
Pathways <- c(posdf$X[1:4],negdf$X[1:8])
dfm <- dfm[dfm$Combined_Pvals<0.251,]
#use pval according to what was set#use pval according to what Xwas set
for (x in Pathways) {
a <- nrow(df_all[df_all$Pathway==x & df_all$Pval < 0.05 & df_all$Treatment =="T1",])
T1 <- c(T1,a)
b <- nrow(df_all[df_all$Pathway==x & df_all$Pval < 0.05 & df_all$Treatment =="T2",])
T2 <- c(T2,b)
}
dfm$Path <- Pathways
dfm$T1 <- T1
dfm$T2 <- T2
View(dfm)
#bubble plots
library(openxlsx)
#Load the following dataframes from MetaboAnalyst results
posdf <- read.csv("metaboanalyst/Positive/mummicho_pathway_enrichment_integ.csv")
negdf <- read.csv("metaboanalyst/Negative/mummicho_pathway_enrichment_integ.csv")
#Import these datafiles, because they should the compound hits
posdf2 <- read.csv("metaboanalyst/Positive/mummichog_pathway_enrichment_integ.csv")
negdf2 <- read.csv("metaboanalyst/Negative/mummichog_pathway_enrichment_integ.csv")
#Merge them, get it from df2 add it to df2
posdf$cpd.hits <- posdf2$cpd.hits[match(posdf$X,posdf2$X)]
negdf$cpd.hits <- negdf2$cpd.hits[match(negdf$X,negdf2$X)]
#Importing files with t values stat
pos_stat <- read.csv("metaboanalyst/Positive/data_original.csv")
posdf3 <- read.csv("metaboanalyst/Positive/mummichog_matched_compound_all.csv")
colnames(posdf3) <- c("Mass","Compound","MatchedForm","MassDiff")
neg_stat <- read.csv("metaboanalyst/Negative/data_original.csv")
negdf3 <- read.csv("metaboanalyst/Negative/mummichog_matched_compound_all.csv")
colnames(negdf3) <- c("Mass","Compound","MatchedForm","MassDiff")
View(posdf3)
#bubble plots
library(openxlsx)
#load from metaboanalyst output files
posdf <- read.csv("metaboanalyst/Positive/mummicho_pathway_enrichment_integ.csv")
negdf <- read.csv("metaboanalyst/Negative/mummicho_pathway_enrichment_integ.csv")
#load from metaboanalyst output files
posdf2 <- read.csv("metaboanalyst/Positive/mummichog_pathway_enrichment_integ.csv")
negdf2 <- read.csv("metaboanalyst/Negative/mummichog_pathway_enrichment_integ.csv")
#Merge them, get it from df2 add it to df2
posdf$cpd.hits <- posdf2$cpd.hits[match(posdf$X,posdf2$X)]
negdf$cpd.hits <- negdf2$cpd.hits[match(negdf$X,negdf2$X)]
#Importing files with t values stat
pos_stat <- read.csv("metaboanalyst/Positive/data_original.csv")
posdf3 <- read.csv("metaboanalyst/Positive/mummichog_matched_compound_all.csv")
colnames(posdf3) <- c("Mass","Compound","MatchedForm","MassDiff")
neg_stat <- read.csv("metaboanalyst/Negative/data_original.csv")
negdf3 <- read.csv("metaboanalyst/Negative/mummichog_matched_compound_all.csv")
colnames(negdf3) <- c("Mass","Compound","MatchedForm","MassDiff")
#For loop to get compound hits per pathway in positive mode, only including top 4
df0 <- data.frame()
for (x in 1:4) {
Compound <- unlist(strsplit(posdf$cpd.hits[x], ";"))
num <- as.numeric(length(unlist(strsplit(posdf$cpd.hits[x], ";"))))
Pathway <- rep(posdf[x,"X"],num)
Mode <- rep("Pos",num)
tmp <- data.frame(Compound,Pathway,Mode)
df0 <- rbind(df0,tmp)
}
View(df0)
df0_merged <- merge(df0, posdf3, by = "Compound")
View(df0_merged)
df0_merged$Stat <- pos_stat$t.score[match(df0_merged$Mass,pos_stat$m.z)]
df0_merged$Pval <- pos_stat$p.value[match(df0_merged$Mass,pos_stat$m.z)]
df0_merged$Treatment <- ifelse(df0_merged$Stat>0,"T1","T2")
#For loop to get compound hits per pathway in positive mode, only including top 4
df0 <- data.frame()
for (x in 1:4) {
Compound <- unlist(strsplit(posdf$cpd.hits[x], ";"))
num <- as.numeric(length(unlist(strsplit(posdf$cpd.hits[x], ";"))))
Pathway <- rep(posdf[x,"X"],num)
Mode <- rep("Pos",num)
tmp <- data.frame(Compound,Pathway,Mode)
df0 <- rbind(df0,tmp)
}
#Match compound id, by getting query mass, then which matches to another file with tval, pval
df0_merged <- merge(df0, posdf3, by = "Compound")
df0_merged$Stat <- pos_stat$t.score[match(df0_merged$Mass,pos_stat$m.z)]
df0_merged$Pval <- pos_stat$p.value[match(df0_merged$Mass,pos_stat$m.z)]
df0_merged$Treatment <- ifelse(df0_merged$Stat>0,"T1","T2")
View(df0_merged)
### Negative ion mode - get which compounds are elevated in T1 or T2
#negative mode, including top 8 so 1:8
df1 <- data.frame()
for (x in 1:8) {
Compound <- unlist(strsplit(negdf$cpd.hits[x], ";"))
num <- as.numeric(length(unlist(strsplit(negdf$cpd.hits[x], ";"))))
Pathway <- rep(negdf[x,"X"],num)
Mode <- rep("Neg",num)
tmp <- data.frame(Compound,Pathway,Mode)
df1 <- rbind(df1,tmp)
}
df1_merged <- merge(df1, negdf3, by = "Compound")
df1_merged$Stat <- neg_stat$t.score[match(df1_merged$Mass,neg_stat$m.z)]
df1_merged$Pval <- neg_stat$p.value[match(df1_merged$Mass,neg_stat$m.z)]
df1_merged$Treatment <- ifelse(df1_merged$Stat>0,"T1","T2")
T1 <- c()
T2 <- c()
dfm <- rbind(posdf,negdf)
Pathways <- c(posdf$X[1:4],negdf$X[1:8])
dfm <- dfm[dfm$Combined_Pvals<0.251,]
View(dfm)
#use pval according to what was set#use pval according to what Xwas set
for (x in Pathways) {
a <- nrow(df_all[df_all$Pathway==x & df_all$Pval < 0.05 & df_all$Treatment =="T1",])
T1 <- c(T1,a)
b <- nrow(df_all[df_all$Pathway==x & df_all$Pval < 0.05 & df_all$Treatment =="T2",])
T2 <- c(T2,b)
}
dfm$Path <- Pathways
dfm$T1 <- T1
dfm$T2 <- T2
View(dfm)
View(posdf)
View(dfm)
#Getting number of those significant elevated per treatment and per pathway
# Below is getting all per compound, a compound can have multiple matches
T1 <- c()
T2 <- c()
dfm <- rbind(posdf,negdf)
Pathways <- c(posdf$X[1:4],negdf$X[1:8])
dfm <- dfm[dfm$Combined_Pvals<0.251,]
View(dfm)
for (x in Pathways) {
a <- nrow(df_all[df_all$Pathway==x & df_all$Pval < 0.05 & df_all$Treatment =="T1",])
T1 <- c(T1,a)
b <- nrow(df_all[df_all$Pathway==x & df_all$Pval < 0.05 & df_all$Treatment =="T2",])
T2 <- c(T2,b)
}
#Getting number of those significant elevated per treatment and per pathway
# Below is getting all per compound, a compound can have multiple matches
T1 <- c()
T2 <- c()
dfm <- rbind(posdf,negdf)
Pathways <- c(posdf$X[1:4],negdf$X[1:8])
dfm <- dfm[dfm$Combined_Pvals<0.251,] # using 0.251 to only get top 10 pathways
#use pval according to what was set#use pval according to what Xwas set
for (x in Pathways) {
a <- nrow(df_all[df_all$Pathway==x & df_all$Pval < 0.05 & df_all$Treatment =="T1",])
T1 <- c(T1,a)
b <- nrow(df_all[df_all$Pathway==x & df_all$Pval < 0.05 & df_all$Treatment =="T2",])
T2 <- c(T2,b)
}
T1 <- df_all[df_all$Pval < 0.05 & df_all$Treatment =="T1",]
View(T1)
#For loop to get how many per pathway is elevated, by counting how many are unique per pathway
uniqueT1 <-c()
Path <- c()
for (x in unique(T1$Pathway)) {
a <- length(unique(T1[T1$Pathway==x,"Compound"]))
uniqueT1 <- c(uniqueT1,a)
y <- x
Path <- c(Path,y)
}
T1df <- data.frame(uniqueT1,Path)
View(T1df)
#Getting all together
#df_all2 is our data from above gathered from mummichog analysis via metaboanalyst
df_all2 <- rbind(posdf,negdf)
#matching by pathway to get the unique compounds elevated per treatment
df_all2$T1 <- T1df$uniqueT1[match(df_all2$X,T1df$Path)]
df_all2$T2 <- T2df$uniqueT2[match(df_all2$X,T2df$Path)]
#For loop to get how many per pathway is elevated, by counting how many are unique per pathway
uniqueT1 <-c()
Path <- c()
for (x in unique(T1$Pathway)) {
a <- length(unique(T1[T1$Pathway==x,"Compound"]))
uniqueT1 <- c(uniqueT1,a)
y <- x
Path <- c(Path,y)
}
T1df <- data.frame(uniqueT1,Path)
T2 <- df_all[df_all$Pval < 0.05 & df_all$Treatment =="T2",]
uniqueT2 <-c()
Path <- c()
for (x in unique(T2$Pathway)) {
a <- length(unique(T2[T2$Pathway==x,"Compound"]))
uniqueT2 <- c(uniqueT2,a)
y <- x
Path <- c(Path,y)
}
T2df <- data.frame(uniqueT2,Path)
#Getting all together
#df_all2 is our data from above gathered from mummichog analysis via metaboanalyst
df_all2 <- rbind(posdf,negdf)
#matching by pathway to get the unique compounds elevated per treatment
df_all2$T1 <- T1df$uniqueT1[match(df_all2$X,T1df$Path)]
df_all2$T2 <- T2df$uniqueT2[match(df_all2$X,T2df$Path)]
df_all2[is.na(df_all2)] <- 0
View(df_all2)
View(dfm)
#bubble plots
library(openxlsx)
#load from metaboanalyst output files
posdf <- read.csv("metaboanalyst/Positive/mummicho_pathway_enrichment_integ.csv")
negdf <- read.csv("metaboanalyst/Negative/mummicho_pathway_enrichment_integ.csv")
#load from metaboanalyst output files
posdf2 <- read.csv("metaboanalyst/Positive/mummichog_pathway_enrichment_integ.csv")
negdf2 <- read.csv("metaboanalyst/Negative/mummichog_pathway_enrichment_integ.csv")
#Merge them, get it from df2 add it to df2
posdf$cpd.hits <- posdf2$cpd.hits[match(posdf$X,posdf2$X)]
negdf$cpd.hits <- negdf2$cpd.hits[match(negdf$X,negdf2$X)]
#Importing files with t values stat
pos_stat <- read.csv("metaboanalyst/Positive/data_original.csv")
posdf3 <- read.csv("metaboanalyst/Positive/mummichog_matched_compound_all.csv")
colnames(posdf3) <- c("Mass","Compound","MatchedForm","MassDiff")
neg_stat <- read.csv("metaboanalyst/Negative/data_original.csv")
negdf3 <- read.csv("metaboanalyst/Negative/mummichog_matched_compound_all.csv")
colnames(negdf3) <- c("Mass","Compound","MatchedForm","MassDiff")
### Positive ion mode - get which compounds are elevated in T1 or T2
#For loop to get compound hits per pathway in positive mode, only including top 4
df0 <- data.frame()
for (x in 1:4) {
Compound <- unlist(strsplit(posdf$cpd.hits[x], ";"))
num <- as.numeric(length(unlist(strsplit(posdf$cpd.hits[x], ";"))))
Pathway <- rep(posdf[x,"X"],num)
Mode <- rep("Pos",num)
tmp <- data.frame(Compound,Pathway,Mode)
df0 <- rbind(df0,tmp)
}
#Match compound id, by getting query mass, then which matches to another file with tval, pval
df0_merged <- merge(df0, posdf3, by = "Compound")
df0_merged$Stat <- pos_stat$t.score[match(df0_merged$Mass,pos_stat$m.z)]
df0_merged$Pval <- pos_stat$p.value[match(df0_merged$Mass,pos_stat$m.z)]
df0_merged$Treatment <- ifelse(df0_merged$Stat>0,"T1","T2")
### Negative ion mode - get which compounds are elevated in T1 or T2
#negative mode, including top 8 so 1:8
df1 <- data.frame()
for (x in 1:8) {
Compound <- unlist(strsplit(negdf$cpd.hits[x], ";"))
num <- as.numeric(length(unlist(strsplit(negdf$cpd.hits[x], ";"))))
Pathway <- rep(negdf[x,"X"],num)
Mode <- rep("Neg",num)
tmp <- data.frame(Compound,Pathway,Mode)
df1 <- rbind(df1,tmp)
}
df1_merged <- merge(df1, negdf3, by = "Compound")
df1_merged$Stat <- neg_stat$t.score[match(df1_merged$Mass,neg_stat$m.z)]
df1_merged$Pval <- neg_stat$p.value[match(df1_merged$Mass,neg_stat$m.z)]
df1_merged$Treatment <- ifelse(df1_merged$Stat>0,"T1","T2")
#Bind both pos and neg compound hits
df_all <- rbind(df0_merged,df1_merged)
# write.xlsx(df_all,"EnrichmentKEGGcompounds_stat.xlsx") # to export if needed
#Getting number of those significant elevated per treatment and per pathway
# Below is getting all per compound, a compound can have multiple matches
T1 <- c()
T2 <- c()
dfm <- rbind(posdf,negdf)
Pathways <- c(posdf$X[1:4],negdf$X[1:8])
dfm <- dfm[dfm$Combined_Pvals<0.251,] # using 0.251 to only get top 10 pathways
# To get how many compounds per pathway were elevated according to treatment
for (x in Pathways) {
a <- nrow(df_all[df_all$Pathway==x & df_all$Pval < 0.05 & df_all$Treatment =="T1",])
T1 <- c(T1,a)
b <- nrow(df_all[df_all$Pathway==x & df_all$Pval < 0.05 & df_all$Treatment =="T2",])
T2 <- c(T2,b)
}
dfm$Path <- Pathways
dfm$T1 <- T1
dfm$T2 <- T2
View(dfm)
library(pathview)
setwd("~/Desktop/Others/Portfolio/Metabolome_study")
library(pathview)
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("pathview")
library(pathview)
#bubble plots
library(openxlsx)
#Load the following dataframes from MetaboAnalyst results
#These show the top 5 pathways
posdf <- read.csv("metabonalyst/Positive/mummicho_pathway_enrichment_integ.csv")
setwd("~/Desktop/Others/Portfolio/Metabolome_study")
library(pathview)
#bubble plots
library(openxlsx)
#Load the following dataframes from MetaboAnalyst results
#These show the top 5 pathways
posdf <- read.csv("metabonalyst/Positive/mummicho_pathway_enrichment_integ.csv")
setwd("~/Desktop/Others/Portfolio/Metabolome_study")
#bubble plots
library(openxlsx)
#Load the following dataframes from MetaboAnalyst results
#These show the top 5 pathways
posdf <- read.csv("metaboanalyst/Positive/mummicho_pathway_enrichment_integ.csv")
posdf$Top <- c(rep("Top",3),rep("No",nrow(posdf)-3))
library(pathview)
#bubble plots
library(openxlsx)
#Load the following dataframes from MetaboAnalyst results
#These show the top 5 pathways
posdf <- read.csv("metaboanalyst/Positive/mummicho_pathway_enrichment_integ.csv")
posdf$Top <- c(rep("Top",3),rep("No",nrow(posdf)-3))
posdf <- posdf[posdf$Top=="Top",]
negdf <- read.csv("metabonalyst/Negative/mummicho_pathway_enrichment_integ.csv")
negdf <- read.csv("metaboanalyst/Negative/mummicho_pathway_enrichment_integ.csv")
library(pathview)
#bubble plots
library(openxlsx)
#Load the following dataframes from MetaboAnalyst results
#These show the top 5 pathways
posdf <- read.csv("metaboanalyst/Positive/mummicho_pathway_enrichment_integ.csv")
posdf$Top <- c(rep("Top",3),rep("No",nrow(posdf)-3))
posdf <- posdf[posdf$Top=="Top",]
negdf <- read.csv("metaboanalyst/Negative/mummicho_pathway_enrichment_integ.csv")
negdf$Top <- c(rep("Top",8),rep("No",nrow(negdf)-8))
negdf <- negdf[negdf$Top=="Top",]
library(pathview)
#bubble plots
library(openxlsx)
#Load the following dataframes from MetaboAnalyst results
#These show the top 5 pathways
posdf <- read.csv("metaboanalyst/Positive/mummicho_pathway_enrichment_integ.csv")
posdf$Top <- c(rep("Top",3),rep("No",nrow(posdf)-3))
posdf <- posdf[posdf$Top=="Top",]
negdf <- read.csv("metaboanalyst/Negative/mummicho_pathway_enrichment_integ.csv")
negdf$Top <- c(rep("Top",8),rep("No",nrow(negdf)-8))
negdf <- negdf[negdf$Top=="Top",]
#Import these datafiles, because they should the compound hits
posdf2 <- read.csv("metaboanalyst/Positive/mummichog_pathway_enrichment_integ.csv")
library(pathview)
#bubble plots
library(openxlsx)
#Load the following dataframes from MetaboAnalyst results
#These show the top 5 pathways
posdf <- read.csv("metaboanalyst/Positive/mummicho_pathway_enrichment_integ.csv")
posdf$Top <- c(rep("Top",3),rep("No",nrow(posdf)-3))
posdf <- posdf[posdf$Top=="Top",]
negdf <- read.csv("metaboanalyst/Negative/mummicho_pathway_enrichment_integ.csv")
negdf$Top <- c(rep("Top",8),rep("No",nrow(negdf)-8))
negdf <- negdf[negdf$Top=="Top",]
#Import these datafiles, because they should the compound hits
posdf2 <- read.csv("metaboanalyst/Positive/mummichog_pathway_enrichment_integ.csv")
negdf2 <- read.csv("metaboanalyst/Negative/mummichog_pathway_enrichment_integ.csv")
library(pathview)
#bubble plots
library(openxlsx)
#Load the following dataframes from MetaboAnalyst results
#These show the top 5 pathways
posdf <- read.csv("metaboanalyst/Positive/mummicho_pathway_enrichment_integ.csv")
posdf$Top <- c(rep("Top",3),rep("No",nrow(posdf)-3))
posdf <- posdf[posdf$Top=="Top",]
negdf <- read.csv("metaboanalyst/Negative/mummicho_pathway_enrichment_integ.csv")
negdf$Top <- c(rep("Top",8),rep("No",nrow(negdf)-8))
negdf <- negdf[negdf$Top=="Top",]
#Import these datafiles, because they should the compound hits
posdf2 <- read.csv("metaboanalyst/Positive/mummichog_pathway_enrichment_integ.csv")
negdf2 <- read.csv("metaboanalyst/Negative/mummichog_pathway_enrichment_integ.csv")
#Merge them, get it from df2 add it to df2
posdf$cpd.hits <- posdf2$cpd.hits[match(posdf$X,posdf2$X)]
negdf$cpd.hits <- negdf2$cpd.hits[match(negdf$X,negdf2$X)]
pos1<- unlist(strsplit(posdf$cpd.hits[1], ";")) #"Phenylalanine metabolism"
pos2<- unlist(strsplit(posdf$cpd.hits[2], ";")) #"Tryptophan metabolism"
pos3<- unlist(strsplit(posdf$cpd.hits[3], ";")) # "Phenylalanine, tyrosine and tryptophan biosynthesis"
neg1<- unlist(strsplit(negdf$cpd.hits[1], ";")) # "Glutathione metabolism"
neg2<- unlist(strsplit(negdf$cpd.hits[2], ";")) # "Glycerophospholipid metabolism"
neg3<- unlist(strsplit(negdf$cpd.hits[3], ";")) # "beta-Alanine metabolism"
neg5<- unlist(strsplit(negdf$cpd.hits[5], ";")) # "N-Glycan biosynthesis"
neg8<- unlist(strsplit(negdf$cpd.hits[8], ";")) # "Thiamine metabolism"
